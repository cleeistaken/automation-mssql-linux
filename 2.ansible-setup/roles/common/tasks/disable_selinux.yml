---
- name: Set distribution
  set_fact:
    is_centos: "{{ ansible_distribution == 'CentOS' }}"
    is_debian: "{{ ansible_distribution == 'Debian' }}"
    is_redhat: "{{ ansible_distribution == 'RedHat' }}"
    is_ubuntu: "{{ ansible_distribution == 'Ubuntu' }}"

- name: Print distribution
  debug:
    msg: "CentOS: {{ is_centos }}\nDebian: {{ is_debian }}\nRedHat: {{ is_redhat }}\nUbuntu: {{ is_ubuntu }}"

- name: Install required libraries Ubuntu
  apt:
    name:
      - python3-selinux
      - selinux-policy-default
    state: present
  when: is_ubuntu

- name: Disable SELinux
  ansible.posix.selinux:
    state: disabled
  register: selinux_state

- name: Perform reboot if required
  reboot:
    reboot_timeout: 300
  when: selinux_state.changed

